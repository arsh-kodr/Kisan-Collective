{
  "info": {
    "name": "Kisan Collective API (Full with Payments)",
    "_postman_id": "merged-collection-1234",
    "description": "Postman collection for testing all routes of Kisan Collective backend (Auth, User, Listings, Lots, Bids, Payments with Razorpay)",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Health Check",
      "request": {
        "method": "GET",
        "header": [],
        "url": "{{base_url}}/api/health"
      }
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Register Farmer",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"farmer1\",\n  \"fullName\": {\"firstName\": \"Ram\", \"lastName\": \"Singh\"},\n  \"email\": \"farmer1@example.com\",\n  \"password\": \"password123\",\n  \"mobile\": \"9876543210\",\n  \"role\": \"farmer\"\n}"
            }
          }
        },
        {
          "name": "Register Buyer",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"buyer1\",\n  \"fullName\": {\"firstName\": \"Shyam\", \"lastName\": \"Patel\"},\n  \"email\": \"buyer1@example.com\",\n  \"password\": \"password123\",\n  \"mobile\": \"9876500000\",\n  \"role\": \"buyer\"\n}"
            }
          }
        },
        {
          "name": "Register FPO",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/auth/register",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"username\": \"fpo1\",\n  \"fullName\": {\"firstName\": \"Fpo\", \"lastName\": \"Collective\"},\n  \"email\": \"fpo1@example.com\",\n  \"password\": \"password123\",\n  \"mobile\": \"9876511111\",\n  \"role\": \"fpo\"\n}"
            }
          }
        },
        {
          "name": "Login",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "url": "{{base_url}}/api/auth/login",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"farmer1@example.com\",\n  \"password\": \"password123\"\n}"
            }
          }
        },
        {
          "name": "Profile (Protected)",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/auth/profile"
          }
        }
      ]
    },
    {
      "name": "User",
      "item": [
        {
          "name": "Get Profile",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/user/profile"
          }
        },
        {
          "name": "Update Profile",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/user/profile",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"fullName\": {\"firstName\": \"Updated\", \"lastName\": \"Farmer\"},\n  \"mobile\": \"9998887777\"\n}"
            }
          }
        },
        {
          "name": "Change Password",
          "request": {
            "method": "PUT",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/user/profile/password",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"oldPassword\": \"password123\",\n  \"newPassword\": \"newpass456\"\n}"
            }
          }
        },
        {
          "name": "Delete Account",
          "request": {
            "method": "DELETE",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/user/profile"
          }
        }
      ]
    },
    {
      "name": "Listings (Farmer)",
      "item": [
        {
          "name": "Create Listing",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{farmer_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/listings",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"crop\": \"Wheat\",\n  \"quantityKg\": 500,\n  \"harvestDate\": \"2025-08-01\",\n  \"expectedPricePerKg\": 22,\n  \"location\": \"Village A\"\n}"
            }
          }
        },
        {
          "name": "Get All Listings",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/listings"
          }
        }
      ]
    },
    {
      "name": "Lots (FPO)",
      "item": [
        {
          "name": "Create Lot",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{fpo_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/lots",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Wheat Lot 1\",\n  \"listingId\": [\"<listingId>\"]\n}"
            }
          }
        },
        {
          "name": "Get All Lots",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/lots"
          }
        }
      ]
    },
    {
      "name": "Bids (Buyer)",
      "item": [
        {
          "name": "Place Bid",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/bids/place-bid",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lotId\": \"<lotId>\",\n  \"amount\": 12000\n}"
            }
          }
        },
        {
          "name": "Get My Bids",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" }
            ],
            "url": "{{base_url}}/api/bids/my-bids"
          }
        },
        {
          "name": "Get Highest Bid for Lot",
          "request": {
            "method": "GET",
            "header": [{ "key": "Authorization", "value": "Bearer {{token}}" }],
            "url": "{{base_url}}/api/bids/lots/<lotId>/highest"
          }
        },
        {
          "name": "Close Auction (FPO/Admin)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{fpo_token}}" }
            ],
            "url": "{{base_url}}/api/bids/lots/<lotId>/close"
          }
        }
      ]
    },
    {
      "name": "Payments",
      "item": [
        {
          "name": "Initiate Payment",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lotId\": \"{{lotId}}\",\n  \"bidId\": \"{{bidId}}\",\n  \"amount\": 500\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/payment/initiate",
              "host": ["{{base_url}}"],
              "path": ["api", "payment", "initiate"]
            }
          }
        },
        {
          "name": "Verify Payment",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"orderId\": \"{{razorpay_order_id}}\",\n  \"paymentId\": \"{{razorpay_payment_id}}\",\n  \"signature\": \"{{razorpay_signature}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/payment/verify",
              "host": ["{{base_url}}"],
              "path": ["api", "payment", "verify"]
            }
          }
        },
        {
          "name": "Get My Transactions",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" }
            ],
            "url": {
              "raw": "{{base_url}}/api/payment/my-transactions",
              "host": ["{{base_url}}"],
              "path": ["api", "payment", "my-transactions"]
            }
          }
        },
        {
          "name": "Get Lot Payments (FPO/Admin)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{fpo_token}}" }
            ],
            "url": {
              "raw": "{{base_url}}/api/payment/lot/{{lotId}}",
              "host": ["{{base_url}}"],
              "path": ["api", "payment", "lot", "{{lotId}}"]
            }
          }
        },
        {
          "name": "Webhook (test)",
          "request": {
            "method": "POST",
            "header": [{ "key": "Content-Type", "value": "application/json" }],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"event\": \"payment.captured\",\n  \"payload\": {\n    \"payment\": {\n      \"entity\": {\n        \"id\": \"pay_test123\",\n        \"amount\": 50000\n      }\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/payment/webhook",
              "host": ["{{base_url}}"],
              "path": ["api", "payment", "webhook"]
            }
          }
        }
      ]
    },
    {
      "name": "Orders",
      "item": [
        {
          "name": "Create Order (Buyer)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/orders/create",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"lotId\": \"{{lotId}}\",\n  \"shippingAddress\": {\n    \"fullName\": \"Shyam Patel\",\n    \"phone\": \"9876500000\",\n    \"addressLine1\": \"123 Main Street\",\n    \"city\": \"Ahmedabad\",\n    \"state\": \"Gujarat\",\n    \"postalCode\": \"380001\",\n    \"country\": \"India\"\n  }\n}"
            }
          }
        },
        {
          "name": "Get My Orders (Buyer)",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{buyer_token}}" }
            ],
            "url": "{{base_url}}/api/orders/my-orders"
          }
        },
        {
          "name": "Get Orders for FPO",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{fpo_token}}" }
            ],
            "url": "{{base_url}}/api/orders/fpo-orders"
          }
        },
        {
          "name": "Update Order Status (FPO/Admin)",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Authorization", "value": "Bearer {{fpo_token}}" },
              { "key": "Content-Type", "value": "application/json" }
            ],
            "url": "{{base_url}}/api/orders/{{orderId}}/status",
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"shipped\"\n}"
            }
          }
        }
      ]
    }
  ],
  "variable": [
    { "key": "base_url", "value": "http://localhost:3000" },
    { "key": "token", "value": "" },
    { "key": "farmer_token", "value": "" },
    { "key": "buyer_token", "value": "" },
    { "key": "fpo_token", "value": "" },
    { "key": "lotId", "value": "" },
    { "key": "bidId", "value": "" },
    { "key": "orderId", "value": "" },
    { "key": "razorpay_order_id", "value": "" },
    { "key": "razorpay_payment_id", "value": "" },
    { "key": "razorpay_signature", "value": "" }
  ]
}
